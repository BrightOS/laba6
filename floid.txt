#include <bits/stdc++.h>
#include <fstream>

using namespace std;

int n;
int a[100][100];
int b[100][100];
int temp=0;

void pyt(int i, int j)
{
    int flag=0;
    int cont=0;
	int start = i;
	while (a[start][j] != b[start][j])
        {
            for (int k = 0; k < n; k++)
                {
                    if (k != start && k != j && a[start][k] && b[k][j] && a[start][k] + b[k][j] == b[start][j])
                        {
                            flag=1;
                            if(cont==0)
                                cout << i << "->" << j << "(" << b[i][j] << ")" << ":\n         "<< i <<"->";
                            printf("%d(%d)->", k, a[start][k]);
                            start = k;
                            cont++;
                            break;
                        }
                }
        }
	if(flag==1)
        printf("%d(%d)\n", j, a[start][j]);
    flag=0;
}

int main()
{
    srand(time(NULL));
	setlocale(LC_ALL, "Russian");
    printf("1)Чтение из файла\n2)Случайное разыгрывание\n Ваш выбор:");
    scanf("%d",&temp);
    if(temp==1)
        {
            ifstream fscanf("text.txt");
            fscanf >> n;
            for (int i = 0; i < n; i++)
                {
                    for (int j = 0; j < n; j++)
                    {

                        if (i != j)
                            {
                                fscanf >> a[i][j];
                            }
                        else a[i][j] = 0;
                    }
                }
        }
    else
        {
            printf("Введите размерность матрицы:");
            cin>>n;
            for(int i = 0; i < n; i++)                //матрицу задаем
                for(int j = 0; j < n; j++)
                    a[i][j]=rand()%1000;
        }
    //ofstream out("text.txt");

    printf("\nВходная матрица:\n");
	for (int i = 0; i < n; i++)
        {
            for (int j = 0; j < n; j++)
                {
                    if(i == j)
                        {
                            printf("%4s","0");
                            continue;
                        }
                    else printf("%4d", a[i][j]);
                }
             printf("\n");
        }
    printf("\n");

	for (int i = 0; i < n; i++)
		for (int j = 0; j < n; j++)
			b[i][j] = a[i][j];

	while (1)
        {
            int flag = 1;
            for (int i = 0; i < n; i++)
                for (int j = 0; j < n; j++)
                    if (b[i][j])
                        for (int k = 0; k < n; k++)
                            if (k != i && k != j && b[j][k] && (b[i][k] == 0 || b[i][k] > b[i][j] + b[j][k]))
                            {
                                b[i][k] = b[i][j] + b[j][k];
                                flag = 0;
                            }
            if (flag)
                break;
        }

	printf("Матрица кратчайших путей: ");
	printf("\n");
	for (int i = 0; i < n; i++)
        {
            for (int j = 0; j < n; j++)
                {
                    if(i == j)
                        {
                            printf("%4s","0");
                            continue;
                        }
                    cout << setw(4) << b[i][j];
                }
            printf("\n");
        }

	printf("\n");
    printf("Составные пути: \n");
	for (int i = 0; i < n; i++)
		for (int j = 0; j < n; j++)
			if (i != j)
			pyt(i, j);
}
